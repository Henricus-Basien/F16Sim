%{
Created on Tuesday 11.12.2018
Copyright (??) Henricus N. Basien
Author: Henricus N. Basien
Email: Henricus@Basien.de
%}

%****************************************************************************************************
% AE4301P
%****************************************************************************************************

%================================================================================
% Settings
%================================================================================

Settings

%================================================================================
% Linearize Model
%================================================================================

FindF16Dynamics

%================================================================================
% Initialization
%================================================================================

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
% Preliminaries
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

s = tf("s");

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
% Aliases
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

%----------------------------------------
% Input
%----------------------------------------

Ut = 1;
Ue = 2;
Ua = 3;
Ur = 4;

%----------------------------------------
% State
%----------------------------------------

Xnpos  = 1 ;
Xepos  = 2 ;
Xh     = 3 ;
Xphi   = 4 ;
Xtheta = 5 ;
Xpsi   = 6 ;
Xv     = 7 ;
Xalpha = 8 ;
Xbeta  = 9 ;
Xp     = 10;
Xq     = 11;
Xr     = 12;

%----------------------------------------
% Output
%----------------------------------------

Ynpos  = Xnpos  ;
Yepos  = Xepos  ;
Yh     = Xh     ;
Yphi   = Xphi   ;
Ytheta = Xtheta ;
Ypsi   = Xpsi   ;
Yv     = Xv     ;
Yalpha = Xalpha ;
Ybeta  = Xbeta  ;
Yp     = Xp     ;
Yq     = Xq     ;
Yr     = Xr     ;
Yanx   = 13     ;
Yany   = 14     ;
Yanz   = 15     ;
YM     = 16     ;
Yqp    = 17     ;
Ysp    = 18     ;

YNz    = 19     ;

%================================================================================
% Excercises
%================================================================================

a = input("Press ENTER to run Full Analysis...");

fprintf("++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n")
fprintf("                          Q5                                \n")
fprintf("++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n")

fprintf("--- 5.3 ---\n")

C_lo
D_lo

B_Ue = B_lo(:,Ue)
C_Nz = C_lo(YNz,:)
D_Ue = D_lo(:,Ue)

C_Nz
D_Ue

fprintf("--- 5.5 ---\n")
tf_Ue_Nz = minreal(tf(C_Nz * (inv((s*eye(18)-A_lo))*B_Ue)))
step(tf_Ue_Nz)

